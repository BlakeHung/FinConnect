# 阿美族家族APP - 記帳功能 PRD

## 1. 產品概述

### 1.1 背景
家族活動經常需要進行費用收集和分攤，目前缺乏專門的工具進行管理，常導致結算困難和混亂。

### 1.2 目標
開發一個專門的記帳模組，協助家族活動的財務管理，從預算規劃到最終結算，提供完整的解決方案。

### 1.3 使用者角色與權限

#### 1.3.1 活動層級角色

- 活動總召
  * 活動整體規劃
  * 預算控制與審核
  * 最終結算確認
  * 指派支出申報者權限
  * 查看現金池完整資訊

- 支出申報者
  * 登記支出
  * 上傳支出憑證
  * 查看自己提交的支出
  * 查看總預算使用狀況
  * 查看個人收支狀況

#### 1.3.2 系統層級角色

- 超級管理員
  * 查看所有活動資訊
  * 編輯活動內容
  * 管理使用者權限
  * 系統設定管理
  * 查看所有活動現金池

- 財務主記帳
  * 管理所有活動的收支記錄
  * 負責收款事務
  * 登記收款記錄
  * 產生收據
  * 追蹤欠款狀態
  * 製作財務報表
  * 進行結算作業
  * 查看所有現金池資訊

- 超級查看員
  * 查看所有活動資訊
  * 查看所有活動現金池概況
  * 僅有讀取權限
  * 無修改權限

- 訪客
  * 查看即將開始的活動
  * 查看上一次活動記錄
  * 基本公開資訊瀏覽
  * 無法查看現金池資訊

### 1.4 權限管理原則

#### 1.4.1 資訊可見性
- 活動總召：當前活動完整資訊
- 財務主記帳：所有活動財務資訊
- 超級管理員/查看員：所有活動概況
- 支出申報者：限本活動資訊
- 訪客：僅可見基本公開資訊

#### 1.4.2 操作權限
- 活動總召：活動內所有操作權限
- 財務主記帳：所有財務操作權限
- 支出申報者：支出登記權限
- 超級查看員：僅查看權限
- 訪客：無操作權限

#### 1.4.3 資料控管
- 敏感資訊分級管理
- 操作日誌完整記錄
- 定期權限稽核
- 異動紀錄追蹤

### 1.5 登入驗證機制

#### 1.5.1 統一登入介面
- 第一步輸入（必填）：
  * 活動代碼（6位數）
  * 系統管理帳號
  * 留空進入訪客模式

- 第二步驗證（根據第一步）：
  * 活動人員：輸入4位身份碼
  * 系統管理員：輸入管理密碼
  * 訪客：直接進入瀏覽模式

#### 1.5.2 登入安全管理
- 錯誤次數限制
- 登入行為記錄
- 異常登入警告
- 定期密碼更換

## 2. 功能需求

### 2.1 預算管理

#### 2.1.1 預算設定
- 設定活動總預算
- 設定每人預繳金額
- 自動計算預算缺口
- 支援預算調整

#### 2.1.2 預算分類
- 預設支出類別：場地、餐飲、交通、活動等
- 自定義支出類別
- 各類別預算設定
- 預算使用率追蹤

### 2.2 收支記錄

#### 2.2.1 支出記錄
- 基本資訊記錄：
  * 金額
  * 日期
  * 類別
  * 備註
  * 付款人
- 收據上傳：
  * 支援圖片上傳
  * 收據預覽
- 支出分類：
  * 自動分類
  * 手動調整
- 支出標記：
  * 必要/非必要支出
  * 已付款/未付款
  * 暫存/確認

#### 2.2.2 收入記錄
- 預繳費用登記
- 臨時收入記錄
- 付款方式記錄
- 收款確認機制

### 2.3 現金池管理

#### 2.3.1 現金池監控
- 即時餘額顯示
- 待收款追蹤
- 待支付管理
- 現金流預測

#### 2.3.2 資金流動記錄
- 收支明細記錄
- 餘額變動追蹤
- 交易對象紀錄
- 用途說明記錄

#### 2.3.3 查看權限
- 完整資訊：
  * 活動總召
  * 財務主記帳
  * 超級管理員
- 概要資訊：
  * 支出申報者
  * 超級查看員
- 無權限：訪客

### 2.4 財務報表

#### 2.4.1 報表類型
- 總覽報表：
  * 收支概況
  * 預算執行狀況
  * 分類統計
- 明細報表：
  * 收支明細
  * 餘額變動
  * 待處理事項

#### 2.4.2 報表權限
- 完整報表：
  * 財務主記帳
  * 活動總召
  * 超級管理員
- 基本報表：
  * 支出申報者
  * 超級查看員

### 2.5 結算功能

#### 2.5.1 結算作業
- 收支總結
- 分攤計算
- 退補款處理
- 報表生成

#### 2.5.2 結算流程
1. 財務主記帳整理收支
2. 活動總召確認結算
3. 系統計算分攤金額
4. 產生結算報告
5. 處理退補款事宜

## 3. 系統需求

### 3.1 功能性需求
- 多人同時操作
- 即時資料同步
- 離線操作支援
- 自動備份機制

### 3.2 非功能性需求
- 響應時間 < 2秒
- 資料準確性 100%
- 系統可用性 99.9%
- 資料備份即時性

### 3.3 安全性需求
- 資料加密傳輸
- 存取權限控管
- 操作日誌記錄
- 異常行為監控

## 4. 驗收標準

### 4.1 功能驗收
- 角色權限正確
- 收支記錄準確
- 報表計算無誤
- 結算作業正確

### 4.2 效能驗收
- 符合響應時間
- 同時操作正常
- 資料同步即時
- 系統穩定運作